_type_: tp.policy
project: temporal_pooling
log: True    # wandb logging

# FIXME: using &key/*key is error prone with sweeps overwriting
.shared_params:
#  n_states: &n_states 30
#  tp_output_size: &tp_output_size 4000
  n_states: &n_states 10
  n_actions: &n_actions 4
  tp_output_size: &tp_output_size 400
  state_bucket: &state_bucket 10

run_setup: simple
policy_selection_rule: ordered
temporal_pooler: union_tp
seed: 42

run_setups:
  simple:
    n_policies: 3
    n_states: 10
    n_actions: 4
    steps_per_policy: ...
    policy_repeats: 3
    epochs: 2

  full:
    n_policies: 8
    n_states: 30
    n_actions: 4
    steps_per_policy: ...
    policy_repeats: 20
    epochs: 4

generator:
  _type_: synthetic
  n_states: ???
  n_actions: ???
  active_size: 10
  state_encoder: bucket
  action_encoder: random
  policy_similarity: 0.5
  policy_similarity_std: 0.35
  seed: ???

encoders:
  bucket:
    _type_: int_bucket
    n_values: ???
    bucket_size: ???
  random:
    _type_: int_random
    n_values: ???
    space_compression: .75
    active_size: ???
    sds: ...
    seed: ???

temporal_poolers:
  union_tp:
    _type_: UnionTp
    columnDimensions: [*tp_output_size]
    localAreaDensity: 0.01
    maxUnionActivity: &tp_output_sparsity 0.01
    activeOverlapWeight: 1
    predictedActiveOverlapWeight: 2
    exciteFunctionType: Logistic
    decayFunctionType: Exponential
    decayTimeConst: 10.0
    synPermPredActiveInc: 0.1
    synPermPreviousPredActiveInc: 0.05
    historyLength: 20
    minHistory: 3
    boostStrength: 0.0
    globalInhibition: True
    dutyCyclePeriod: 1000
    minPctOverlapDutyCycle: 0.001
    numActiveColumnsPerInhArea: 0
    potentialPct: 0.5
    stimulusThreshold: 3
    synPermConnected: 0.5
    synPermActiveInc: 0.1
    synPermInactiveDec: 0.01
    wrapAround: False

  ablation_utp:
    _type_: AblationUtp
    columnDimensions: [*tp_output_size]
    localAreaDensity: 0.01
    maxUnionActivity: 0.01
    activeOverlapWeight: 1
    predictedActiveOverlapWeight: 2
    exciteFunctionType: Logistic
    decayFunctionType: Exponential
    decayTimeConst: 10.0
    synPermPredActiveInc: 0.1
    synPermPreviousPredActiveInc: 0.05
    historyLength: 20
    minHistory: 3
    boostStrength: 0.0
    globalInhibition: True
    dutyCyclePeriod: 1000
    minPctOverlapDutyCycle: 0.001
    numActiveColumnsPerInhArea: 0
    potentialPct: 0.5
    stimulusThreshold: 3
    synPermConnected: 0.5
    synPermActiveInc: 0.1
    synPermInactiveDec: 0.01
    wrapAround: False
    # ablation
    first_boosting: False
    second_boosting: False
    untemporal_learning: True
    union_learning: True
    history_learning: True

  custom_utp:
    _type_: CustomUtp
    inputDimensions: ...
    columnDimensions: [*tp_output_size]
    initial_pooling: 0.5
    pooling_decay: 0.1
    permanence_inc: 0.1
    permanence_dec: 0.01
    sparsity: 0.004
    active_weight: 0.5
    predicted_weight: 2.0
    receptive_field_sparsity: 0.5
    activation_threshold: 0.6
    history_length: 20
    union_sdr_sparsity: 0.01
    prev_perm_inc: 0.05

  sandwich_tp:
    _type_: SandwichTp
    initial_pooling: 1.
    pooling_decay: 0.05
    lower_sp_conf:
      columnDimensions: [*tp_output_size]
      boostStrength: 0.
      localAreaDensity: 0.01
      globalInhibition: True
      dutyCyclePeriod: 1000
      minPctOverlapDutyCycle: 0.001
      numActiveColumnsPerInhArea: 0
      potentialPct: 0.5
      stimulusThreshold: 3
      synPermConnected: 0.5
      synPermActiveInc: 0.1
      synPermInactiveDec: 0.01
      wrapAround: False
    upper_sp_conf:
      columnDimensions: [*tp_output_size]
      boostStrength: 0.
      localAreaDensity: 0.01
      globalInhibition: True
      dutyCyclePeriod: 1000
      minPctOverlapDutyCycle: 0.001
      numActiveColumnsPerInhArea: 0
      potentialPct: 0.5
      stimulusThreshold: 3
      synPermConnected: 0.5
      synPermActiveInc: 0.1
      synPermInactiveDec: 0.01
      wrapAround: False


temporal_memory:
  cells_per_column: 16
  # apical feedback
  feedback_cells: *tp_output_size
  sample_size_apical: *tp_output_sparsity
  activation_threshold_apical: 0.9
  learning_threshold_apical: 0.8
  connected_threshold_apical: 0.5
  permanence_increment_apical: 0.1
  permanence_decrement_apical: 0.01
  initial_permanence_apical: 0.4
  predicted_segment_decrement_apical: 0.001
  max_segments_per_cell_apical: 32
  # basal context
  activation_threshold_basal: *state_bucket # 1.0
  learning_threshold_basal: *state_bucket # 1.0
  connected_threshold_basal: 0.5
  permanence_increment_basal: 0.1
  permanence_decrement_basal: 0.01
  initial_permanence_basal: 0.4
  predicted_segment_decrement_basal: 0.001
  max_segments_per_cell_basal: 32
  prune_zero_synapses: True
  timeseries: False
  anomaly_window: 1000
  confidence_window: 1000
  noise_tolerance: 0.0
  sm_ac: 0.99
